(()=>{"use strict";var e={763:(e,t,a)=>{var n=a(447);function s(e){return new Promise(((t,a)=>{const n=new FileReader;n.onload=()=>{try{t(JSON.parse(n.result))}catch{a("The provided file failed to be parsed. Please check if it is corrupted.")}},n.onerror=()=>a("File read failed."),n.readAsText(e)}))}class r{constructor(e){this.year=parseInt(e.slice(0,2)),this.season=parseInt(e.slice(2,4))}name(){return"".concat(this.year).concat(this.season)}to_str(){return"20".concat(this.year,"-").concat(this.year- -1," ").concat(function(e){switch(e){case 10:return"Fall";case 20:return"Winter";case 30:return"Spring";case 40:return"Summer";default:return""}}(this.season))}is_last(){return 40===this.season}next(){this.is_last()?(++this.year,this.season=10):this.season+=10}}var o=a(415);function c(e){const t={...e};if("empty"===e.type||"course"===e.type)delete t.error;else{const a=[];for(let t of e.members)a.push(c(t));t.members=a,delete t.error,delete t.error_cred,delete t.error_n}return t}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Set;switch(e.type){case"empty":return t;case"course":return t.add(e);default:for(let a of e.members)i(a,t)}return t}const l={headerRow:!0,totalsRow:!0,columns:[{name:"Code",totalsRowLabel:"Total credit(s):"},{name:"Credit(s)",totalsRowFunction:"sum"}]};function d(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=[];for(let n of e)if(""!==n.code){const e=[n.code,n.cred];t&&e.splice(1,0,n.name),a.push(e)}return a.length?a:[[]]}const u=new n.U("main");u.version(2).stores({plans:"++index, title, startSem, sems",reqs:"name"}),self.onmessage=async e=>{const t=e.data;var a={...t,status:!0};try{switch(t.type){case"init":a.titles={},await u.transaction("rw",u.plans,(async()=>{a.content=await u.plans.get(t.plan),void 0===a.content&&(await u.plans.add({index:t.plan,...t.content}),a.content=t.content)})),await u.plans.each((e=>a.titles[e.index]=e.title));break;case"select":await u.transaction(t.force?"rw":"r",u.plans,(async()=>{const e=await u.plans.get(t.plan);void 0===e?t.force?await u.plans.add({index:t.plan,...t.content}):(a.status=!1,a.fail_message="Plan does not exist."):a.content=e}));break;case"export":{const e=await u.plans.get(t.plan);delete e.index,a.content=JSON.stringify(e);break}case"excel":{const e=function(e){const t=new o.Workbook,a=t.addWorksheet(),n=new r(e.startSem);let s=1,c=1,u=1;for(let r=0;r<e.sems;++r){const t=n.name(),r=e.courses,o=t in r?d(r[t]):[[]];a.getCell(s,c).value=n.to_str(),a.addTable({...l,name:"plan_"+t,ref:a.getCell(s+1,c).$col$row,rows:o}),u=Math.max(u,o.length),n.next(),n.is_last()?(s+=u+4,c=1,u=1):c+=3}s=1,c=13;for(let r=0;r<e.reqs.length;++r){const t=e.reqs[r],n=d(i(t.content));a.getCell(s,c).value=t.name,a.addTable({...l,name:"req_".concat(r),ref:a.getCell(s+1,c).$col$row,rows:n}),s+=n.length+4}s=1,c=16;const p=Object.values(e.courses).flat();return a.getCell(s,c).value="All courses",a.addTable({name:"all_courses",ref:a.getCell(s+1,c).$col$row,headerRow:!0,totalsRow:!0,columns:[{name:"Code",totalsRowLabel:"Total credit(s):"},{name:"Name"},{name:"Credit(s)",totalsRowFunction:"sum"}],rows:d(p,!0)}),t}(await u.plans.get(t.plan));a.content=await e.xlsx.writeBuffer();break}case"add":a.plan=await u.plans.add(t.content);break;case"copy":a.plan=await u.transaction("rw",u.plans,(async()=>{const e={...await u.plans.get(t.plan),...t.content};return delete e.index,await u.plans.add(e)}));break;case"import":try{const e=await s(t.content);a.plan=await u.plans.add(e),a.content=e}catch(n){a.status=!1,a.fail_message=n}break;case"delete":await u.transaction("rw",u.plans,(async()=>{1===await u.plans.count()?(a.status=!1,a.fail_message="The only plan in your collection cannot be deleted."):await u.plans.delete(t.plan)}));break;case"update":await u.plans.update(t.plan,t.content);break;case"req_names":a.content=[],await u.reqs.each((e=>a.content.push(e.name)));break;case"req_select":const e=await u.reqs.get(t.req);void 0===e?(a.status=!1,a.fail_message="Requirement block does not exist."):a.content=e.content;break;case"req_export":{let e;"content"in t?e={name:t.req,content:c(t.content)}:"req"in t&&(e=await u.reqs.get(t.req)),void 0===e?(a.status=!1,a.fail_message="Requirement block does not exist."):a.content=JSON.stringify(e);break}case"req_import":try{const e=await s(t.content);a.req=t.req=e.name;try{a.content=t.content=c(e.content)}catch{throw"The provided file seems to be corrupted."}}catch(n){a.status=!1,a.fail_message=n;break}case"req_add":await u.transaction("rw",u.reqs,(async()=>{!t.force&&await u.reqs.where({name:t.req}).count()?a.clash=!0:(await u.reqs.put({name:t.req,content:t.content}),a.clash=!1)}));break;case"req_delete":const p=t.req;await u.transaction("rw",u.reqs,(async()=>{await u.reqs.where({name:p}).count()?await u.reqs.delete(p):(a.status=!1,a.fail_message="Requirement block does not exist.")}));break;case"req_update":await u.reqs.update(t.req,t.content)}}catch(n){a.status=!1,a.error=n.inner}self.postMessage(a)}}},t={};function a(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.m=e,a.x=()=>{var e=a.O(void 0,[571],(()=>a(763)));return e=a.O(e)},(()=>{var e=[];a.O=(t,n,s,r)=>{if(!n){var o=1/0;for(d=0;d<e.length;d++){n=e[d][0],s=e[d][1],r=e[d][2];for(var c=!0,i=0;i<n.length;i++)(!1&r||o>=r)&&Object.keys(a.O).every((e=>a.O[e](n[i])))?n.splice(i--,1):(c=!1,r<o&&(o=r));if(c){e.splice(d--,1);var l=s();void 0!==l&&(t=l)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,s,r]}})(),a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,n)=>(a.f[n](e,t),t)),[])),a.u=e=>"static/js/"+e+".2b6128b4.chunk.js",a.miniCssF=e=>{},a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.p="/credit-planner/",(()=>{var e={763:1};a.f.i=(t,n)=>{e[t]||importScripts(a.p+a.u(t))};var t=self.webpackChunkcredit_planner=self.webpackChunkcredit_planner||[],n=t.push.bind(t);t.push=t=>{var s=t[0],r=t[1],o=t[2];for(var c in r)a.o(r,c)&&(a.m[c]=r[c]);for(o&&o(a);s.length;)e[s.pop()]=1;n(t)}})(),(()=>{var e=a.x;a.x=()=>a.e(571).then(e)})();a.x()})();
//# sourceMappingURL=763.5a8253eb.chunk.js.map